{"$ref":"#/$defs/ReduxOptions","$defs":{"ReduxOptions":{"title":"ReduxOptions","type":"object","properties":{"name":{"description":"Name of the experiment. It should be a unique name. If you enable auto resume, any experiment with this name will be resumed instead of starting a new training run.","type":"string"},"scale":{"description":"Scale of the model. Most architectures support a scale of 1, 2, 3, 4, or 8. A scale of 1 can be used for restoration models that don't change the resolution of the input image. A scale of 2 means the width and height of the input image are doubled, so a 640x480 input will be upscaled to 1280x960.","type":"integer"},"num_gpu":{"description":"The number of GPUs to use for training, if using multiple GPUs.","anyOf":[{"enum":["auto"]},{"type":"integer"}]},"path":{"$ref":"#/$defs/PathOptions"},"network_g":{"description":"The options for the generator model.","type":"object"},"network_d":{"description":"The options for the discriminator model.","anyOf":[{"type":"object"},{"type":"null"}],"default":null},"manual_seed":{"description":"Deterministic mode, slows down training. Only use for reproducible experiments.","anyOf":[{"type":"integer"},{"type":"null"}],"default":null},"deterministic":{"anyOf":[{"type":"boolean"},{"type":"null"}],"default":null},"dist":{"anyOf":[{"type":"boolean"},{"type":"null"}],"default":null},"launcher":{"anyOf":[{"type":"string"},{"type":"null"}],"default":null},"rank":{"anyOf":[{"type":"integer"},{"type":"null"}],"default":null},"world_size":{"anyOf":[{"type":"integer"},{"type":"null"}],"default":null},"auto_resume":{"anyOf":[{"type":"boolean"},{"type":"null"}],"default":null},"resume":{"type":"integer","default":0},"is_train":{"anyOf":[{"type":"boolean"},{"type":"null"}],"default":null},"root_path":{"anyOf":[{"type":"string"},{"type":"null"}],"default":null},"use_amp":{"description":"Speed up training and reduce VRAM usage. NVIDIA only.","type":"boolean","default":false},"amp_bf16":{"description":"Use bf16 instead of fp16 for AMP, RTX 3000 series or newer only. Only recommended if fp16 doesn't work.","type":"boolean","default":false},"use_channels_last":{"description":"Enable channels last memory format while using AMP. Reduces VRAM and speeds up training for most architectures, but some architectures are slower with channels last.","type":"boolean","default":true},"fast_matmul":{"description":"Trade precision for performance.","type":"boolean","default":false},"use_compile":{"description":"Enable torch.compile for the generator model, which takes time on startup to compile the model, but can speed up training after the model is compiled.","type":"boolean","default":false},"detect_anomaly":{"description":"Whether or not to enable anomaly detection, which can be useful for debugging NaNs that occur during training. Has a significant performance hit and should be disabled when not debugging.","type":"boolean","default":false},"high_order_degradation":{"description":"Whether or not to enable OTF (on the fly) degradations, which generates LRs on the fly.","type":"boolean","default":false},"high_order_degradations_debug":{"description":"Whether or not to enable debugging for OTF, which saves the OTF generated LR images so they can be inspected to view the effect of different OTF settings.","type":"boolean","default":false},"high_order_degradations_debug_limit":{"description":"The maximum number of OTF images to save when debugging is enabled.","type":"integer","default":100},"dataroot_lq_prob":{"description":"Probability of using paired LR data instead of OTF LR data.","type":"number","default":0},"force_high_order_degradation_filename_masks":{"type":"array","items":{"type":"string"},"default":[]},"force_dataroot_lq_filename_masks":{"type":"array","items":{"type":"string"},"default":[]},"lq_usm":{"type":"boolean","default":false},"lq_usm_radius_range":{"type":"array","minItems":2,"maxItems":2,"prefixItems":[{"type":"integer"},{"type":"integer"}],"items":false,"default":[1,25]},"blur_prob":{"type":"number","default":0},"resize_prob":{"type":"array","items":{"type":"number"}},"resize_mode_list":{"type":"array","items":{"type":"string"}},"resize_mode_prob":{"type":"array","items":{"type":"number"}},"resize_range":{"type":"array","minItems":2,"maxItems":2,"prefixItems":[{"type":"number"},{"type":"number"}],"items":false,"default":[0.4,1.5]},"gaussian_noise_prob":{"type":"number","default":0},"noise_range":{"type":"array","minItems":2,"maxItems":2,"prefixItems":[{"type":"number"},{"type":"number"}],"items":false,"default":[0,0]},"poisson_scale_range":{"type":"array","minItems":2,"maxItems":2,"prefixItems":[{"type":"number"},{"type":"number"}],"items":false,"default":[0,0]},"gray_noise_prob":{"type":"number","default":0},"jpeg_prob":{"type":"number","default":1},"jpeg_range":{"type":"array","minItems":2,"maxItems":2,"prefixItems":[{"type":"number"},{"type":"number"}],"items":false,"default":[75,95]},"blur_prob2":{"type":"number","default":0},"resize_prob2":{"type":"array","items":{"type":"number"}},"resize_mode_list2":{"type":"array","items":{"type":"string"}},"resize_mode_prob2":{"type":"array","items":{"type":"number"}},"resize_range2":{"type":"array","minItems":2,"maxItems":2,"prefixItems":[{"type":"number"},{"type":"number"}],"items":false,"default":[0.6,1.2]},"gaussian_noise_prob2":{"type":"number","default":0},"noise_range2":{"type":"array","minItems":2,"maxItems":2,"prefixItems":[{"type":"number"},{"type":"number"}],"items":false,"default":[0,0]},"poisson_scale_range2":{"type":"array","minItems":2,"maxItems":2,"prefixItems":[{"type":"number"},{"type":"number"}],"items":false,"default":[0,0]},"gray_noise_prob2":{"type":"number","default":0},"jpeg_prob2":{"type":"number","default":1},"jpeg_range2":{"type":"array","items":{"type":"number"}},"resize_mode_list3":{"type":"array","items":{"type":"string"}},"resize_mode_prob3":{"type":"array","items":{"type":"number"}},"queue_size":{"type":"integer","default":180},"datasets":{"type":"object","additionalProperties":{"$ref":"#/$defs/DatasetOptions"},"default":{}},"train":{"anyOf":[{"type":"null"},{"$ref":"#/$defs/TrainOptions"}],"default":null},"val":{"anyOf":[{"type":"null"},{"$ref":"#/$defs/ValOptions"}],"default":null},"logger":{"anyOf":[{"type":"null"},{"$ref":"#/$defs/LogOptions"}],"default":null},"dist_params":{"anyOf":[{"type":"object"},{"type":"null"}],"default":null},"onnx":{"anyOf":[{"type":"null"},{"$ref":"#/$defs/OnnxOptions"}],"default":null},"find_unused_parameters":{"type":"boolean","default":false}},"required":["name","scale","num_gpu","path","network_g"],"additionalProperties":false},"PathOptions":{"title":"PathOptions","type":"object","properties":{"experiments_root":{"anyOf":[{"type":"string"},{"type":"null"}],"default":null},"models":{"anyOf":[{"type":"string"},{"type":"null"}],"default":null},"resume_models":{"anyOf":[{"type":"string"},{"type":"null"}],"default":null},"training_states":{"anyOf":[{"type":"string"},{"type":"null"}],"default":null},"log":{"anyOf":[{"type":"string"},{"type":"null"}],"default":null},"visualization":{"anyOf":[{"type":"string"},{"type":"null"}],"default":null},"results_root":{"anyOf":[{"type":"string"},{"type":"null"}],"default":null},"pretrain_network_g":{"anyOf":[{"type":"string"},{"type":"null"}],"default":null},"pretrain_network_g_path":{"anyOf":[{"type":"string"},{"type":"null"}],"default":null},"param_key_g":{"anyOf":[{"type":"string"},{"type":"null"}],"default":null},"strict_load_g":{"type":"boolean","default":true},"resume_state":{"anyOf":[{"type":"string"},{"type":"null"}],"default":null},"pretrain_network_g_ema":{"anyOf":[{"type":"string"},{"type":"null"}],"default":null},"pretrain_network_d":{"anyOf":[{"type":"string"},{"type":"null"}],"default":null},"param_key_d":{"anyOf":[{"type":"string"},{"type":"null"}],"default":null},"strict_load_d":{"type":"boolean","default":true},"ignore_resume_networks":{"anyOf":[{"type":"array","items":{"type":"string"}},{"type":"null"}],"default":null}},"required":[],"additionalProperties":false},"DatasetOptions":{"title":"DatasetOptions","type":"object","properties":{"name":{"description":"Name of the dataset. It should be unique compared to other datasets in this config, but the exact name isn't very important.","type":"string"},"type":{"type":"string"},"io_backend":{"type":"object"},"num_worker_per_gpu":{"description":"Number of subprocesses to use for data loading with PyTorch dataloader.","anyOf":[{"type":"integer"},{"type":"null"}],"default":null},"batch_size_per_gpu":{"description":"Increasing stabilizes training but going too high can cause issues. Use multiple of 8 for best performance with AMP. A higher batch size, like 32 or 64 is more important when training from scratch, while smaller batches like 8 can be used when training with a quality pretrain model.","anyOf":[{"type":"integer"},{"type":"null"}],"default":null},"accum_iter":{"description":"Using values larger than 1 simulates higher batch size by trading performance for reduced VRAM usage. If accum_iter = 4 and batch_size_per_gpu = 6 then effective batch size = 4 * 6 = 24 but performance may be as much as 4 times as slow.","type":"integer","default":1},"use_hflip":{"description":"Randomly flip the images horizontally.","type":"boolean","default":true},"use_rot":{"description":"Randomly rotate the images.","type":"boolean","default":true},"mean":{"anyOf":[{"type":"array","items":{"type":"number"}},{"type":"null"}],"default":null},"std":{"anyOf":[{"type":"array","items":{"type":"number"}},{"type":"null"}],"default":null},"gt_size":{"anyOf":[{"type":"integer"},{"type":"null"}],"default":null},"lq_size":{"description":"During training, a square of this size is cropped from LR images. Larger is usually better but uses more VRAM. Previously gt_size, use lq_size = gt_size / scale to convert. Use multiple of 8 for best performance with AMP.","anyOf":[{"type":"integer"},{"type":"null"}],"default":null},"color":{"anyOf":[{"enum":["y"]},{"type":"null"}],"default":null},"phase":{"anyOf":[{"type":"string"},{"type":"null"}],"default":null},"scale":{"anyOf":[{"type":"integer"},{"type":"null"}],"default":null},"dataset_enlarge_ratio":{"description":"Increase if the dataset is less than 1000 images to avoid slowdowns. Auto will automatically enlarge small datasets only.","anyOf":[{"enum":["auto"]},{"type":"integer"}],"default":"auto"},"prefetch_mode":{"anyOf":[{"type":"string"},{"type":"null"}],"default":null},"pin_memory":{"type":"boolean","default":true},"persistent_workers":{"type":"boolean","default":true},"num_prefetch_queue":{"type":"integer","default":1},"prefetch_factor":{"type":"integer","default":2},"clip_size":{"anyOf":[{"type":"integer"},{"type":"null"}],"default":null},"dataroot_gt":{"description":"Path to the HR (high res) images in your training dataset. Specify one or multiple folders, separated by commas.","anyOf":[{"type":"string"},{"type":"array","items":{"type":"string"}},{"type":"null"}],"default":null},"dataroot_lq":{"description":"Path to the LR (low res) images in your training dataset. Specify one or multiple folders, separated by commas.","anyOf":[{"type":"string"},{"type":"array","items":{"type":"string"}},{"type":"null"}],"default":null},"meta_info":{"anyOf":[{"type":"string"},{"type":"null"}],"default":null},"filename_tmpl":{"type":"string","default":"{}"},"blur_kernel_size":{"type":"integer","default":12},"kernel_list":{"type":"array","items":{"type":"string"}},"kernel_prob":{"type":"array","items":{"type":"number"}},"kernel_range":{"type":"array","minItems":2,"maxItems":2,"prefixItems":[{"type":"integer"},{"type":"integer"}],"items":false,"default":[5,17]},"sinc_prob":{"type":"number","default":0},"blur_sigma":{"type":"array","minItems":2,"maxItems":2,"prefixItems":[{"type":"number"},{"type":"number"}],"items":false,"default":[0.2,2]},"betag_range":{"type":"array","minItems":2,"maxItems":2,"prefixItems":[{"type":"number"},{"type":"number"}],"items":false,"default":[0.5,4]},"betap_range":{"type":"array","minItems":2,"maxItems":2,"prefixItems":[{"type":"number"},{"type":"number"}],"items":false,"default":[1,2]},"blur_kernel_size2":{"type":"integer","default":12},"kernel_list2":{"type":"array","items":{"type":"string"}},"kernel_prob2":{"type":"array","items":{"type":"number"}},"kernel_range2":{"type":"array","minItems":2,"maxItems":2,"prefixItems":[{"type":"integer"},{"type":"integer"}],"items":false,"default":[5,17]},"sinc_prob2":{"type":"number","default":0},"blur_sigma2":{"type":"array","minItems":2,"maxItems":2,"prefixItems":[{"type":"number"},{"type":"number"}],"items":false,"default":[0.2,1]},"betag_range2":{"type":"array","minItems":2,"maxItems":2,"prefixItems":[{"type":"number"},{"type":"number"}],"items":false,"default":[0.5,4]},"betap_range2":{"type":"array","minItems":2,"maxItems":2,"prefixItems":[{"type":"number"},{"type":"number"}],"items":false,"default":[1,2]},"final_sinc_prob":{"type":"number","default":0},"final_kernel_range":{"type":"array","minItems":2,"maxItems":2,"prefixItems":[{"type":"integer"},{"type":"integer"}],"items":false,"default":[5,17]}},"required":["name","type","io_backend"],"additionalProperties":false},"TrainOptions":{"title":"TrainOptions","type":"object","properties":{"total_iter":{"description":"The total number of iterations to train.","type":"integer"},"optim_g":{"description":"The optimizer to use for the generator model.","type":"object"},"ema_decay":{"description":"The decay factor to use for EMA (exponential moving average). Set to 0 to disable EMA.","type":"number","default":0},"grad_clip":{"description":"Whether or not to enable gradient clipping, which can improve stability when using higher learning rates, but can also cause issues in some situations.","type":"boolean","default":false},"warmup_iter":{"description":"Gradually ramp up learning rates until this iteration, to stabilize early training. Use -1 to disable.","type":"integer","default":-1},"scheduler":{"description":"Options for the optimizer scheduler. If there are multiple optimizers, both will use the same scheduler options.","anyOf":[{"type":"null"},{"$ref":"#/$defs/SchedulerOptions"}],"default":null},"optim_d":{"description":"The optimizer to use for the discriminator model.","anyOf":[{"type":"object"},{"type":"null"}],"default":null},"losses":{"description":"The list of loss functions to optimize.","anyOf":[{"type":"array","items":{"type":"object"}},{"type":"null"}],"default":null},"pixel_opt":{"anyOf":[{"type":"object"},{"type":"null"}],"default":null},"mssim_opt":{"anyOf":[{"type":"object"},{"type":"null"}],"default":null},"ms_ssim_l1_opt":{"anyOf":[{"type":"object"},{"type":"null"}],"default":null},"perceptual_opt":{"anyOf":[{"type":"object"},{"type":"null"}],"default":null},"contextual_opt":{"anyOf":[{"type":"object"},{"type":"null"}],"default":null},"dists_opt":{"anyOf":[{"type":"object"},{"type":"null"}],"default":null},"hr_inversion_opt":{"anyOf":[{"type":"object"},{"type":"null"}],"default":null},"dinov2_opt":{"anyOf":[{"type":"object"},{"type":"null"}],"default":null},"topiq_opt":{"anyOf":[{"type":"object"},{"type":"null"}],"default":null},"pd_opt":{"anyOf":[{"type":"object"},{"type":"null"}],"default":null},"fd_opt":{"anyOf":[{"type":"object"},{"type":"null"}],"default":null},"ldl_opt":{"anyOf":[{"type":"object"},{"type":"null"}],"default":null},"hsluv_opt":{"anyOf":[{"type":"object"},{"type":"null"}],"default":null},"gan_opt":{"anyOf":[{"type":"object"},{"type":"null"}],"default":null},"color_opt":{"anyOf":[{"type":"object"},{"type":"null"}],"default":null},"luma_opt":{"anyOf":[{"type":"object"},{"type":"null"}],"default":null},"avg_opt":{"anyOf":[{"type":"object"},{"type":"null"}],"default":null},"bicubic_opt":{"anyOf":[{"type":"object"},{"type":"null"}],"default":null},"use_moa":{"description":"Whether to enable mixture of augmentations, which augments the dataset on the fly to create more variety and help the model generalize.","type":"boolean","default":false},"moa_augs":{"description":"The list of augmentations to choose from, only one is selected per iteration.","type":"array","items":{"type":"string"}},"moa_probs":{"description":"The probability each augmentation in moa_augs will be applied. Total should add up to 1.","type":"array","items":{"type":"number"}},"moa_debug":{"description":"Save images before and after augment to debug/moa folder inside of the root training directory.","type":"boolean","default":false},"moa_debug_limit":{"description":"The max number of iterations to save augmentation images for.","type":"integer","default":100}},"required":["total_iter","optim_g"],"additionalProperties":false},"SchedulerOptions":{"title":"SchedulerOptions","type":"object","properties":{"type":{"type":"string"},"milestones":{"description":"List of milestones, iterations where the learning rate is reduced.","type":"array","items":{"type":"integer"}},"gamma":{"description":"At each milestone, the learning rate is multiplied by this number, so a gamma of 0.5 cuts the learning rate in half at each milestone.","type":"number"}},"required":["type","milestones","gamma"],"additionalProperties":false},"ValOptions":{"title":"ValOptions","type":"object","properties":{"val_enabled":{"description":"Whether to enable validations. If disabled, all validation settings below are ignored.","type":"boolean"},"save_img":{"description":"Whether to save the validation images during validation, in the experiments/<name>/visualization folder.","type":"boolean"},"val_freq":{"description":"How often to run validations, in iterations.","anyOf":[{"type":"integer"},{"type":"null"}],"default":null},"suffix":{"description":"Optional suffix to append to saved filenames.","anyOf":[{"type":"string"},{"type":"null"}],"default":null},"metrics_enabled":{"description":"Whether to run metrics calculations during validation.","type":"boolean","default":false},"metrics":{"anyOf":[{"type":"object"},{"type":"null"}],"default":null},"pbar":{"type":"boolean","default":true}},"required":["val_enabled","save_img"],"additionalProperties":false},"LogOptions":{"title":"LogOptions","type":"object","properties":{"print_freq":{"description":"How often to print logs to the console, in iterations.","type":"integer"},"save_checkpoint_freq":{"description":"How often to save model checkpoints and training states, in iterations.","type":"integer"},"use_tb_logger":{"description":"Whether or not to enable TensorBoard logging.","type":"boolean"},"save_checkpoint_format":{"description":"Format to save model checkpoints.","enum":["pth","safetensors"],"default":"safetensors"},"wandb":{"anyOf":[{"type":"null"},{"$ref":"#/$defs/WandbOptions"}],"default":null}},"required":["print_freq","save_checkpoint_freq","use_tb_logger"],"additionalProperties":false},"WandbOptions":{"title":"WandbOptions","type":"object","properties":{"resume_id":{"anyOf":[{"type":"string"},{"type":"null"}],"default":null},"project":{"anyOf":[{"type":"string"},{"type":"null"}],"default":null}},"required":[],"additionalProperties":false},"OnnxOptions":{"title":"OnnxOptions","type":"object","properties":{"dynamo":{"type":"boolean","default":false},"opset":{"type":"integer","default":20},"use_static_shapes":{"type":"boolean","default":false},"shape":{"type":"string","default":"3x256x256"},"verify":{"type":"boolean","default":true},"fp16":{"type":"boolean","default":false},"optimize":{"type":"boolean","default":true}},"required":[],"additionalProperties":false}}}